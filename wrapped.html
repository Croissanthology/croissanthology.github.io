<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Croissanthology Wrapped 2025</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poiret+One&display=swap');
        
        /* --- THEME VARIABLES --- */
        :root {
            --bg-deep: #18121e;
            --lavender-bright: #bfaee3;
            --lavender-muted: #8e81a2;
            --cream: #fdfbf7;
            --font-stack: 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif;
            --font-banner: 'Poiret One', cursive; /* The new cool font */
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: var(--font-stack);
            background-color: var(--bg-deep);
            color: var(--cream);
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.5s ease;
        }

        /* --- BACKGROUND CANVAS --- */
        #bg-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1; opacity: 0.8; transition: filter 0.5s ease;
        }

        /* --- MAIN CONTAINER --- */
        .story-container {
            position: relative; z-index: 10;
            width: 100%; max-width: 450px;
            height: 100%; max-height: 900px;
            display: flex; flex-direction: column;
        }

        /* --- PROGRESS BARS --- */
        .progress-container {
            position: absolute; top: 15px; left: 0; width: 100%;
            display: flex; gap: 4px; padding: 0 12px; z-index: 20;
        }
        .progress-bar {
            flex: 1; height: 4px; background: rgba(255,255,255,0.3);
            border-radius: 2px; overflow: hidden;
        }
        .progress-fill {
            height: 100%; width: 0%; background: var(--cream);
            transition: width 0.2s linear;
            box-shadow: 0 0 8px rgba(255,255,255,0.6);
        }
        .progress-bar.completed .progress-fill { width: 100%; }
        .progress-bar.active .progress-fill { width: 100%; } 

        /* --- SLIDES & ANIMATIONS --- */
        .slide {
            flex: 1; display: none;
            flex-direction: column; justify-content: center; align-items: center;
            padding: 40px; text-align: center;
        }
        .slide.active { display: flex; }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes scalePop {
            0% { opacity: 0; transform: scale(0.5); }
            70% { transform: scale(1.1); }
            100% { opacity: 1; transform: scale(1); }
        }

        .slide.active h1, .slide.active h2, .slide.active .banner-title { 
            animation: fadeInUp 0.8s cubic-bezier(0.25, 1, 0.5, 1) forwards; 
        }
        .slide.active p, .slide.active .sub-info { 
            animation: fadeInUp 0.8s cubic-bezier(0.25, 1, 0.5, 1) 0.2s forwards; 
        }
        .slide.active .big-number { 
            animation: scalePop 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; 
        }
        .slide.active .button-link, .slide.active .patron-img { 
            animation: fadeInUp 0.8s ease 0.4s forwards; 
        }

        /* Initial hidden state */
        .slide h1, .slide h2, .slide p, .slide .big-number, .slide .button-link, .slide .patron-img, .banner-title { opacity: 0; }

        /* --- TYPOGRAPHY --- */
        /* The Banner Title Style */
        .banner-title {
            font-family: var(--font-banner);
            font-size: 3.5rem;
            font-weight: 800;
            line-height: 0.9;
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        h1 { font-size: 3rem; font-weight: 800; margin-bottom: 24px; letter-spacing: -1.5px; line-height: 1.1; }
        h2 { font-size: 2.2rem; font-weight: 700; margin-bottom: 16px; letter-spacing: -1px; }
        p { font-size: 1.2rem; font-weight: 600; line-height: 1.5; color: var(--lavender-bright); }

        .gradient-text, .big-number {
            background: linear-gradient(135deg, #fff 0%, var(--lavender-muted) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            transition: background 0.5s ease;
        }

        .big-number { font-size: 9rem; font-weight: 900; letter-spacing: -6px; line-height: 1; margin-bottom: 10px; }

        /* --- FLASH TRANSITION --- */
        body.transitioning { background-color: #2a0e35; }
        body.transitioning #bg-canvas { filter: hue-rotate(180deg) saturate(300%); }
        body.transitioning .gradient-text, body.transitioning .big-number {
            background: linear-gradient(90deg, #ff00cc, #3333ff, #00ccff, #ff00cc);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shimmer 0.5s linear infinite;
        }
        @keyframes shimmer { to { background-position: 200% center; } }

        /* --- LINKS --- */
        a.button-link {
            display: inline-block; margin-top: 25px;
            color: var(--bg-deep); background-color: var(--cream);
            text-decoration: none; padding: 14px 28px; border-radius: 50px;
            font-weight: 800; font-size: 0.9rem; text-transform: uppercase;
            letter-spacing: 1px; transition: transform 0.2s, background-color 0.2s;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3); position: relative; z-index: 30;
        }
        a.button-link:hover { transform: scale(1.05); background-color: #fff;}

        .agi-link {
            color: var(--cream); text-decoration: none;
            border-bottom: 2px solid var(--lavender-muted);
            padding-bottom: 2px; position: relative; z-index: 30;
            transition: color 0.2s; white-space: nowrap;
        }
        .agi-link:hover { color: #fff; border-bottom-color: #fff;}

        .link-bubble {
            display: inline-flex; justify-content: center; align-items: center;
            vertical-align: super; font-size: 0.6em; width: 18px; height: 18px;
            background-color: var(--lavender-bright); color: var(--bg-deep);
            border-radius: 50%; margin-left: 4px; font-weight: bold;
        }

        /* --- IMAGES --- */
        .patron-img {
            max-width: 85%; border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.6); margin-top: 30px;
            transform: rotate(-4deg); border: 4px solid var(--cream);
        }

        /* --- TAP ZONES --- */
        .tap-zone { position: absolute; top: 0; height: 100%; width: 40%; z-index: 15; cursor: pointer; }
        .left-zone { left: 0; }
        .right-zone { right: 0; }

        @media (max-width: 600px) {
            .banner-title { font-size: 2.8rem; }
            h1 { font-size: 2.5rem; }
            h2 { font-size: 1.8rem; }
            .big-number { font-size: 7rem; }
        }
    </style>
</head>
<body>

<canvas id="bg-canvas"></canvas>

<div class="story-container">
    <div class="tap-zone left-zone" onclick="prevSlide()"></div>
    <div class="tap-zone right-zone" onclick="nextSlide()"></div>
    <div class="progress-container" id="progress-bars"></div>

    <div class="slide active">
        <div class="banner-title gradient-text">
            CROISSANTHOLOGY<br>
            DOT COM
        </div>
        
        <p style="margin-top: 20px; font-size: 1.4rem; color: #fff; opacity: 0.9;" class="sub-info">
            your 2025 AD <br>
            <a href="https://www.metaculus.com/questions/5121/date-of-artificial-general-intelligence/" target="_blank" class="agi-link">
                <span id="agi-calc">Calculating...</span><sup class="link-bubble">↗</sup>
            </a>
            <br>in review.
        </p>
    </div>

    <div class="slide">
        <span class="big-number">35</span>
        <h2>"in progress"<br>posts</h2>
        <a href="https://croissanthology.com/all/" target="_blank" class="button-link">See Published</a>
    </div>

    <div class="slide">
        <span class="big-number">14</span>
        <h2>"finished"<br>posts</h2>
        <p>published on Croiss Lite</p>
        <a href="https://croissanthology.substack.com" target="_blank" class="button-link">Read on Substack</a>
    </div>

    <div class="slide">
        <h2 style="font-size: 2.5rem;" class="gradient-text">A bunch of new design elements added to the website!</h2>
        <a href="https://croissanthology.com/design-notes" target="_blank" class="button-link">Design Notes</a>
    </div>

    <div class="slide">
        <span class="big-number" style="font-size: 6rem;">33.40 USD</span>
        <h2>made from Patreon.</h2>
    </div>

    <div class="slide">
        <h2 style="font-size: 2.8rem;">
            Countless 
            <br style="display: block; content: ''; margin-bottom: 10px;">
            <a href="https://x.com/croissanthology" target="_blank" class="agi-link" style="font-size: 2.8rem;">
                Tweets<sup class="link-bubble">↗</sup>
            </a>
        </h2>
        <p>(number unspecified)</p>
    </div>

    <div class="slide">
        <h2>Your<br>Croissanthology<br>type is...</h2>
        <p style="margin-top:40px; font-style: italic; opacity: 0.7;">(Drumroll please...)</p>
    </div>

    <div class="slide">
        <h1 style="font-size: 4rem; color: var(--lavender-bright); margin-bottom: 5px;" class="gradient-text">Sole<br>Patron!</h1>
        <img src="images/thankfulscrooge.jpg" alt="Thankful Scrooge" class="patron-img">
    </div>

    <div class="slide">
        <h1 style="font-size: 3.5rem;">Thank you<br>for sticking<br>around!</h1>
        <p>See you next year.</p>
    </div>

</div>

<script>
    /* --- 1. AGI LOGIC (FIXED) --- */
    async function fetchAGI() {
        const display = document.getElementById('agi-calc');
        const currentYear = new Date().getFullYear(); // 2025
        let predictionYear = 2033; // Default fallback
        
        // This is Question 5121 on Metaculus
        const targetUrl = 'https://www.metaculus.com/api/posts/5121/';
        const proxyUrl = 'https://corsproxy.io/?' + encodeURIComponent(targetUrl);

        try {
            const response = await fetch(proxyUrl);
            if (response.ok) {
                const data = await response.json();
                const centers = data?.question?.aggregations?.recency_weighted?.latest?.centers;
                
                if (centers && centers.length > 0) {
                    const timestamp = centers[0];
                    const dateObj = new Date(timestamp * 1000);
                    const fetchedYear = dateObj.getFullYear();
                    
                    // --- SANITY CHECK (The Bug Fix) ---
                    // If fetchedYear is older than now (e.g. 1970 due to 0 timestamp), 
                    // ignore it and keep the default 2033.
                    if (fetchedYear > currentYear) {
                        predictionYear = fetchedYear;
                        console.log("Metaculus fetch success:", predictionYear);
                    } else {
                        console.log("Fetched year seems wrong (past), utilizing fallback:", fetchedYear);
                    }
                }
            }
        } catch (e) { console.log("Fetch failed, utilizing fallback."); }

        // Calculate Difference
        // 2033 - 2025 = 8
        const diff = predictionYear - currentYear;
        
        // Display
        display.innerText = `(-${diff} S)`;
    }

    /* --- 2. CANVAS ANIMATION --- */
    const canvas = document.getElementById('bg-canvas');
    const ctx = canvas.getContext('2d');
    let width, height;
    let blobs = [];
    let speedMultiplier = 1; 

    function resize() {
        width = canvas.width = window.innerWidth;
        height = canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    class Blob {
        constructor() { this.init(); }
        init() {
            this.x = Math.random() * width; this.y = Math.random() * height;
            this.baseVx = (Math.random() - 0.5) * 0.8;
            this.baseVy = (Math.random() - 0.5) * 0.8;
            this.radius = Math.random() * 150 + 100; 
            const colors = ['#8e81a2', '#bfaee3', '#5a4a6e'];
            this.color = colors[Math.floor(Math.random() * colors.length)];
        }
        update() {
            this.x += this.baseVx * speedMultiplier;
            this.y += this.baseVy * speedMultiplier;
            if (this.x < -100 || this.x > width + 100) this.baseVx *= -1;
            if (this.y < -100 || this.y > height + 100) this.baseVy *= -1;
        }
        draw() {
            ctx.beginPath(); ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = this.color; ctx.fill();
        }
    }

    for(let i=0; i<6; i++) blobs.push(new Blob());

    function animate() {
        ctx.clearRect(0,0,width,height);
        ctx.filter = 'blur(80px)';
        blobs.forEach(b => { b.update(); b.draw(); });
        ctx.filter = 'none'; 
        requestAnimationFrame(animate);
    }
    animate();

    /* --- 3. NAVIGATION --- */
    const slides = document.querySelectorAll('.slide');
    const progressContainer = document.getElementById('progress-bars');
    let currentSlide = 0;
    let isAnimating = false;

    slides.forEach(() => {
        let bar = document.createElement('div');
        bar.className = 'progress-bar';
        bar.innerHTML = '<div class="progress-fill"></div>';
        progressContainer.appendChild(bar);
    });
    const bars = document.querySelectorAll('.progress-bar');

    function triggerTransitionFlash() {
        if(isAnimating) return;
        isAnimating = true;
        document.body.classList.add('transitioning');
        speedMultiplier = 8;
        setTimeout(() => {
            document.body.classList.remove('transitioning');
            speedMultiplier = 1;
            isAnimating = false;
        }, 600);
    }

    function updateView() {
        slides.forEach((slide, i) => {
            slide.classList.remove('active');
            if (i === currentSlide) slide.classList.add('active');
        });
        bars.forEach((bar, i) => {
            bar.classList.remove('active', 'completed');
            if (i < currentSlide) bar.classList.add('completed');
            if (i === currentSlide) bar.classList.add('active');
        });
    }

    function nextSlide() {
        if (currentSlide < slides.length - 1 && !isAnimating) {
            triggerTransitionFlash();
            currentSlide++;
            updateView();
        }
    }

    function prevSlide() {
        if (currentSlide > 0 && !isAnimating) {
            triggerTransitionFlash();
            currentSlide--;
            updateView();
        }
    }

    document.addEventListener('keydown', (e) => {
        if (e.key === "ArrowRight" || e.key === " ") nextSlide();
        if (e.key === "ArrowLeft") prevSlide();
    });

    fetchAGI();
    updateView();

</script>
</body>
</html>